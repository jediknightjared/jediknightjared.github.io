<!DOCTYPE html>
<html>
	<head>
		<title> Level 1 </title>
		<link rel="stylesheet" type="text/css" href="https://jediknightjared.github.io/main.css">
		<script src="https://simplycoding.org/files/simplyjs/simply.js"></script>
		<link id="page_favicon" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAASUlEQVQ4T+2TMQ4AMAgC4f+PtjG2TjLRUVbNaQQJIGCICQjBILKcUjOqYwE/bmC4WC7YAO3yTYFoIPFyMO/QMVpAPsuoPqJj4wHvRDQBPTkovgAAAABJRU5ErkJggg==" rel="icon" type="image/x-icon">
		<script>
			function start(){
				sjs.open("target",800,500);

				var background = new sjs.Image("Images/background.png"); 
				background.setSize(2500, 500); 
				
				//Bottom
				var bottom = new sjs.Image("Images/background.png");
				bottom.setSize(2500, 1);
				bottom.type = "bottom";
				bottom.bottom();
				
				//Menu
				var menu = new sjs.Image("Images/menu.png")
				menu.node.onclick = function() {
					window.location = "index.html";
				};
				menu.offset(10,10);
				menu.fixed = true;
				
				sjs.loadImageArray('[{"width":136,"height":30,"x":155,"y":381,"sx":0,"sy":0,"topSpeed":10,"src":"Images/platform.png","type":"platform","friction":0.05,"classType":"Image"},{"width":136,"height":30,"x":376,"y":278,"sx":0,"sy":0,"topSpeed":10,"src":"Images/platform.png","type":"platform","friction":0.05,"classType":"Image"},{"width":136,"height":30,"x":582,"y":198,"sx":0,"sy":0,"topSpeed":10,"src":"Images/platform.png","type":"platform","friction":0.05,"classType":"Image"},{"width":136,"height":30,"x":827.4411425000296,"y":197,"sx":0,"sy":0,"topSpeed":10,"src":"Images/platform.png","type":"platform","friction":0.05,"classType":"Image"}]');
				
				
				//Player Properties
				var player = new sjs.Image("Images/r_idle.png");
				player.type = "player";
				player.setSize(85,94);
				player.setHFlipImages('Images/l_idle.png', 'Images/r_idle.png');
				player.setGravity();
				player.friction = 0.3;
				player.bottom();
				player.faceRight();
				
				spawnX = 1;
				spawnY = 500;
				
				function die() {
					//sjs.destroyAll();
					//start();
					
					player.x = spawnX;
					player.y = spawnY;
				}
				
				function spawnPoint(x,y){
					spawnX = x;
					spawnY = y;
				}
				
				//Player movement controls
				
				//Right
				var r_walk = 1;
				var r_facing = true;
				sjs.keyDown(RIGHT_KEY, function() {
					r_facing = true;
					if (r_walk == 1) {
						player.setImage("Images/r_walk-0.png");
						player.faceRight();
						player.pushRight(1.5);
						r_walk = 2;
					} else if (r_walk == 2) {
						player.setImage("Images/r_walk-1.png");
						player.faceRight();
						player.pushRight(1.5);
						r_walk = 3;
					} else if (r_walk == 3) {
						player.setImage("Images/r_walk-2.png");
						player.faceRight();
						player.pushRight(1.5);
						r_walk = 4;
					} else if (r_walk == 4) {
						player.setImage("Images/r_walk-3.png");
						player.faceRight();
						player.pushRight(1.5);
						r_walk = 5;
					} else if (r_walk == 5) {
						player.setImage("Images/r_walk-4.png");
						player.faceRight();
						player.pushRight(1.5);
						r_walk = 6;
					} else if (r_walk == 6) {
						player.setImage("Images/r_walk-5.png");
						player.faceRight();
						player.pushRight(1.5);
						r_walk = 7;
					} else if (r_walk == 7) {
						player.setImage("Images/r_walk-6.png");
						player.faceRight();
						player.pushRight(1.5);
						r_walk = 8;
					} else if (r_walk == 8) {
						player.setImage("Images/r_walk-7.png");
						player.faceRight();
						player.pushRight(1.5);
						r_walk = 9;
					} else if (r_walk == 9) {
						player.setImage("Images/r_walk-0.png");
						player.faceRight();
						player.pushRight(1.5);
						r_walk = 1;
					} else {
						player.setImage("Images/r_jump.png");
						player.pushRight(1.5); 
					}
					
				});
				
				//Left
				var l_walk = 1;
				var l_facing = true;
				sjs.keyDown(LEFT_KEY, function() {
					l_facing = true;
					r_facing = false;
					if (l_walk == 1) {
						player.setImage("Images/l_walk-0.png");
						player.faceLeft();
						player.pushLeft(1.5);
						l_walk = 2;
					} else if (l_walk == 2) {
						player.setImage("Images/l_walk-1.png");
						player.faceLeft();
						player.pushLeft(1.5);
						l_walk = 3;
					} else if (l_walk == 3) {
						player.setImage("Images/l_walk-2.png");
						player.faceLeft();
						player.pushLeft(1.5);
						l_walk = 4;
					} else if (l_walk == 4) {
						player.setImage("Images/l_walk-3.png");
						player.faceLeft();
						player.pushLeft(1.5);
						l_walk = 5;
					} else if (l_walk == 5) {
						player.setImage("Images/l_walk-4.png");
						player.faceLeft();
						player.pushLeft(1.5);
						l_walk = 6;
					} else if (l_walk == 6) {
						player.setImage("Images/l_walk-5.png");
						player.faceLeft();
						player.pushLeft(1.5);
						l_walk = 7;
					} else if (l_walk == 7) {
						player.setImage("Images/l_walk-6.png");
						player.faceLeft();
						player.pushLeft(1.5);
						l_walk = 8;
					} else if (l_walk == 8) {
						player.setImage("Images/l_walk-7.png");
						player.faceLeft();
						player.pushLeft(1.5);
						l_walk = 9;
					} else if (l_walk == 9) {
						player.setImage("Images/l_walk-0.png");
						player.faceLeft();
						player.pushLeft(1.5);
						l_walk = 1;
					} else {
						player.setImage("Images/l_jump.png");
						player.pushLeft(1.5); 
					}
					
				});
				
				
				//Jumping
				var canJump = true;
				sjs.keyDown(UP_KEY, function() {
					if (canJump) {
						r_walk = 10;
						l_walk = 10;
						canJump = false;
						player.pushUp(45);
						player.setGravity(3);
						
						if (r_facing) {
							player.setImage("Images/r_jump.png")
						} else {
							player.setImage("Images/l_jump.png")
						}
						
					}

				});
				
				//stop
				window.addEventListener("keyup", function(e) {
					if (e.keyCode == RIGHT_KEY) {
						player.setImage("Images/r_idle.png");
						r_walk = 1;
						l_walk = 1;
					} else if (e.keyCode == LEFT_KEY) {
						player.setImage("Images/l_idle.png");
						r_walk = 1;
						l_walk = 1; 
					} //end if statement
				}); //end EventListener function
				
				canShoot = false;
				
				sjs.keyDown(DOWN_KEY, function(){
					if(canShoot) {
						canShoot = false;
						var laser = new sjs.Image("Images/laser.png");
						laser.type = "laser";
						laser.setSize(100,50);
						laser.friction= 0;
						laser.noBounds= true;
						if(r_facing == true){
							laser.moveTo(player.getX()+44,player.getY()+7);
							laser.pushRight(25.5);
						} else {
							laser.moveTo(player.getX()+-60,player.getY()+7);
							laser.pushLeft(25.5);
						}
						setTimeout(function(){
							canShoot = true;
						},500);
					}
				});
				
				//Collide with platforms
				sjs.onHit("player","platform", function(player,platform){
					r_walk = 1;
					l_walk = 1;
					if (player.isTopOf(platform)) {
						canJump = true;
					}
					
					if (r_facing) {
						player.setImage("Images/r_idle.png");

					} else {
						player.setImage("Images/l_idle.png");
					}
					
					sjs.stoppedBy(player,platform);
				});
				
				//Collide bottom
				sjs.onHit("player","bottom", function(x,y){
					r_walk = 1;
					l_walk = 1;
					canJump = true;
					if (r_facing) {
						player.setImage("Images/r_idle.png");
						
					} else {
						player.setImage("Images/l_idle.png");
					}
					sjs.stoppedBy(x,y);
					
				});
				
				//Collide JumpPad
				sjs.onHit("player","jump_pad", function(x,y){
					if(x.isAboveOf(y) == true){
						player.pushUp(60); 
					} else {
						sjs.stoppedBy(x,y); 
					}
				});
				
				sjs.onHit("player","enemy", function(player,enemy){
					die();
				});
				
				sjs.onHit("enemy","bottom_screen", function(x,y){
					sjs.stoppedBy(x,y);
				});
				
				sjs.onHit("player","flag", function(player,flag) {
					spawnPoint(flag.x,flag.y);
					flag.setImage("Images/flag_bad.png");
					flag.setWidth(29);
				});
				
				sjs.onHit("player","endFlag", function(player,flag) {
					if (localStorage.levelOn = levels) {
						window.location = "win.html";
					} else {
						localStorage.levelOn += 1;
						play();
					}
				});
				
				sjs.onHit("laser","platform", function(laser,platform) {
					laser.destroy();
				});
				
				sjs.onHit("laser","enemy", function(laser,enemy) {
					enemy.destroy();
					laser.destroy();
				});
				
				sjs.onHit("enemy",["left_screen","right_screen"], function(x,y){
				sjs.bounceOff(x,y);
			});
				
				sjs.onHit("enemy","platform", function(x,y){
				if(x.isAboveOf(y) == true){
					sjs.stoppedBy(x,y); 
				} else {
					sjs.bounceOff(x,y); 
				}
			});
				
				sjs.onHit("player","powerUp", function (player, PUp) {
					canShoot = true;
					PUp.destroy();
				});
				
				sjs.onHit("player","score", function(player,score) {
					scoreNum += 10;
					scoreTXT.setText("Score: " + scoreNum);
					score.destroy();
					
				});
				
				//Make the player control the camera
				sjs.scrollable(player,background);
				
			}
		</script>
	</head>
	<body onload="start()">
		<div id="nav">
		<img src="https://jediknightjared.github.io/Images/Logo.png" id="logo">
		</div>
		<div id="mainBody">
		
		
		<h1> Platform Game Level 1</h1>

		<div id="target" style="margin:auto;background:grey;"></div>
		</div>
	</body>
</html>